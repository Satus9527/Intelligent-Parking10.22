# 智能停车场系统 - 手动配置环境指南

本指南提供了不使用Docker的情况下，手动配置智能停车场系统运行环境的详细步骤。

## 一、组件安装与配置

### 1. MySQL数据库配置

#### 1.1 安装MySQL 8.0.28+

**Windows系统安装：**

1. 访问 [MySQL官方下载页](https://dev.mysql.com/downloads/installer/)
2. 下载并运行MySQL Installer
3. 选择「Developer Default」安装类型
4. 按照安装向导完成安装（记住设置的root密码）
5. 安装完成后，确保MySQL服务已启动

**验证安装：**

```bash
mysql --version
```

#### 1.2 创建数据库和用户

1. 打开命令提示符，登录MySQL：

```bash
mysql -u root -p
```

2. 输入安装时设置的root密码

3. 创建数据库：

```sql
CREATE DATABASE parking_db DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

4. 创建用户并授权：

```sql
CREATE USER 'parking_admin'@'localhost' IDENTIFIED BY 'parking_password';
GRANT ALL PRIVILEGES ON parking_db.* TO 'parking_admin'@'localhost';
FLUSH PRIVILEGES;
```

5. 退出MySQL：

```sql
EXIT;
```

#### 1.3 导入数据库脚本

在项目根目录执行以下命令导入数据库结构和测试数据：

```bash
mysql -u parking_admin -p parking_db < init.sql
```

输入密码 `parking_password` 完成导入。

### 2. Redis服务配置

#### 2.1 安装Redis 6.2.6+

**Windows系统安装：**

1. 访问 [Redis for Windows下载页](https://github.com/tporadowski/redis/releases)
2. 下载最新的Redis-x64-*.zip文件
3. 解压到任意目录（如：C:\Redis）
4. 以管理员身份打开命令提示符，进入Redis目录
5. 安装Redis为Windows服务：

```bash
redis-server --service-install redis.windows.conf --loglevel verbose
```

6. 启动Redis服务：

```bash
redis-server --service-start
```

**验证安装：**

```bash
redis-cli --version
```

#### 2.2 验证Redis连接

测试Redis服务是否正常运行：

```bash
redis-cli ping
```

正常情况下应返回 `PONG`。

### 3. Maven安装配置

#### 3.1 安装Maven 3.8.5+

1. 访问 [Maven官方下载页](https://maven.apache.org/download.cgi)
2. 下载最新的Maven二进制zip文件
3. 解压到任意目录（如：C:\Program Files\Apache\maven）
4. 配置环境变量：
   - 右键「此电脑」→「属性」→「高级系统设置」→「环境变量」
   - 在系统变量中新建 `MAVEN_HOME`，值为Maven安装目录
   - 编辑 `Path` 变量，添加 `%MAVEN_HOME%\bin`

**验证安装：**

```bash
mvn --version
```

#### 3.2 配置Maven镜像源（可选，提高下载速度）

1. 找到Maven安装目录下的conf/settings.xml文件
2. 编辑settings.xml，在<mirrors>标签内添加阿里云镜像：

```xml
<mirror>
  <id>aliyunmaven</id>
  <mirrorOf>*</mirrorOf>
  <name>阿里云公共仓库</name>
  <url>https://maven.aliyun.com/repository/public</url>
</mirror>
```

## 二、应用配置

### 1. 环境变量配置

确保项目根目录下已创建 `.env` 文件，内容如下：

```properties
# 应用基础配置
APP_NAME="智能停车场系统"
APP_ENV="development"
APP_PORT=8080
APP_DEBUG="true"

# 数据库配置
DB_URL=jdbc:mysql://localhost:3306/parking_db?useSSL=false&serverTimezone=UTC
DB_USERNAME=parking_admin
DB_PASSWORD=parking_password

# Redis配置
REDIS_HOST="localhost"
REDIS_PORT=6379
REDIS_PASSWORD=""
REDIS_DATABASE=0

# 第三方服务配置（测试用）
AMAP_API_KEY="test_api_key"
LOG_LEVEL="debug"
```

### 2. 检查配置文件

确保以下配置文件中的设置与上述环境变量一致：

- src/main/resources/application.yml
- src/main/resources/application-dev.yml

## 三、项目构建与运行

### 1. 构建项目

在项目根目录执行以下命令：

```bash
mvn clean install
```

构建过程可能需要几分钟，首次构建会下载所有依赖。

### 2. 运行应用

#### 方法A：使用Maven运行

```bash
mvn spring-boot:run
```

#### 方法B：运行JAR文件

1. 构建成功后，执行以下命令：

```bash
java -jar target/[项目名称]-[版本号].jar
```

（请根据实际生成的JAR文件名替换）

### 3. 验证服务启动

服务启动后，访问以下地址验证：

- 应用主页：http://localhost:8080
- 健康检查接口：http://localhost:8080/actuator/health

## 四、常见问题处理

### 1. 数据库连接失败

- 确认MySQL服务正在运行：`services.msc` 检查MySQL服务状态
- 验证数据库、用户名和密码是否正确
- 检查防火墙是否阻止了3306端口

### 2. Redis连接失败

- 确认Redis服务正在运行：`redis-cli ping` 验证
- 检查Redis配置是否正确
- 检查防火墙是否阻止了6379端口

### 3. Maven构建失败

- 检查网络连接是否正常
- 确认JDK版本是否为11.0.12+
- 尝试清理Maven缓存：`mvn clean`

### 4. 端口冲突

如果8080端口被占用，可以在.env文件中修改APP_PORT值，例如：

```properties
APP_PORT=8088
```

## 五、服务管理

### 1. 停止应用

- 按 `Ctrl+C` 停止正在运行的应用
- 或在任务管理器中结束Java进程

### 2. 重启数据库服务

**MySQL：**
```bash
net stop MySQL80
net start MySQL80
```

**Redis：**
```bash
redis-server --service-stop
redis-server --service-start
```

## 六、后续开发

应用启动成功后，您可以：

1. 访问数据库：使用任意MySQL客户端连接（用户名：parking_admin，密码：parking_password）
2. 查看日志：日志默认输出到控制台和logs目录
3. 开始开发新功能或修改现有代码

祝您开发愉快！