# 智能停车场系统启动指南

## 环境要求

在运行本项目之前，您需要确保已安装以下组件：

| 组件名称 | 版本要求 | 检查命令 |
|---------|---------|---------|
| Java JDK | 11.0.12+ | `java -version` |
| Maven | 3.8.5+ | `mvn --version` |
| MySQL | 8.0.28+ | `mysql --version` |
| Redis | 6.2.6+ | `redis-cli --version` |
| Git | 2.34.1+ | `git --version` |
| Docker (可选) | 20.10.12+ | `docker --version` |

## 环境配置方法

### 方法一：使用Docker快速启动（推荐）

如果您已安装Docker，可以使用提供的docker-compose.yml文件快速搭建开发环境：

1. 确保Docker和docker-compose已正确安装
2. 在项目根目录执行以下命令启动服务：

```bash
docker-compose up -d
```

这将启动：
- MySQL 8.0.28 数据库（端口：3306）
- Redis 6.2.6 缓存服务（端口：6379）
- phpMyAdmin 数据库管理工具（端口：8081）
- Redis Commander Redis管理工具（端口：8082）

数据库会自动初始化，创建所需的表结构和测试数据。

### 方法二：手动配置环境

如果您不使用Docker，需要手动安装和配置各组件：

#### 1. 配置MySQL数据库

- 安装MySQL 8.0.28或更高版本
- 创建数据库：`parking_db`
- 创建用户：`parking_admin` 并设置密码
- 导入数据库结构和测试数据：运行项目根目录下的 `init.sql` 脚本

#### 2. 配置Redis服务

- 安装Redis 6.2.6或更高版本
- 保持默认配置（端口：6379）

## 应用配置

### 环境变量配置

在项目根目录确保已创建 `.env` 文件，内容如下：

```properties
# 应用基础配置
APP_NAME="智能停车场系统"
APP_ENV="development"
APP_PORT=8080
APP_DEBUG="true"

# 数据库配置
DB_URL=jdbc:mysql://localhost:3306/parking_db?useSSL=false&serverTimezone=UTC
DB_USERNAME=parking_admin
DB_PASSWORD=parking_password

# Redis配置
REDIS_HOST="localhost"
REDIS_PORT=6379
REDIS_PASSWORD=""
REDIS_DATABASE=0

# 第三方服务配置（测试用）
AMAP_API_KEY="test_api_key"
LOG_LEVEL="debug"
```

## 项目构建与运行

### 使用Maven构建和运行

1. 在项目根目录执行以下命令构建项目：

```bash
mvn clean install
```

2. 构建成功后，执行以下命令启动应用：

```bash
mvn spring-boot:run
```

### 或者直接运行打包后的JAR文件

```bash
# 打包
mvn package

# 运行JAR文件
java -jar target/parking-system-1.0.0.jar
```

## 验证服务启动

应用启动成功后，您可以通过以下方式验证服务是否正常运行：

1. 访问应用主页：http://localhost:8080/

2. 测试API接口（可以使用Postman或其他API测试工具）：
   - 获取附近停车场：GET http://localhost:8080/api/v1/parking/nearby?longitude=116.465766&latitude=39.924113&radius=5000
   - 获取车位详情：GET http://localhost:8080/api/v1/parking/1
   - 预约车位：POST http://localhost:8080/api/v1/parking/reserve
     - 请求体示例：
     ```json
     {
       "parkingSpaceId": 1,
       "userId": 1001,
       "licensePlate": "京A12345",
       "reserveTime": "2023-10-15T15:30:00"
     }
     ```

3. 访问管理工具：
   - phpMyAdmin：http://localhost:8081/（用户名：parking_admin，密码：parking_password）
   - Redis Commander：http://localhost:8082/

## 常见问题解决

1. **Maven构建失败**：
   - 检查Maven是否正确安装和配置
   - 检查网络连接是否正常（Maven需要下载依赖）

2. **数据库连接失败**：
   - 检查MySQL服务是否启动
   - 检查.env文件中的数据库连接配置是否正确
   - 检查用户权限是否足够

3. **Redis连接失败**：
   - 检查Redis服务是否启动
   - 检查.env文件中的Redis连接配置是否正确

4. **端口被占用**：
   - 如果8080端口被占用，可以修改.env文件中的APP_PORT参数
   - 也可以修改docker-compose.yml中的端口映射配置

## 开发建议

1. 推荐使用IntelliJ IDEA或Eclipse等IDE进行开发
2. 修改代码后可以使用Maven的热重载功能：`mvn spring-boot:run -Dspring-boot.run.fork=false`
3. 开发过程中可以查看logs/app.log文件获取详细日志信息

祝您开发愉快！