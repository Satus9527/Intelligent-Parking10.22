# 智能停车场小程序项目初始化指南

## 一、开发环境准备

### 1.1 必备工具安装
| 工具名称 | 版本要求 | 用途 | 下载地址 |
|---------|---------|------|---------|
| 微信开发者工具 | Stable 1.06+ | 小程序开发/调试/预览 | [微信开放平台](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html) |
| Node.js | v16.14.0+ | npm包管理 | [Node.js官网](https://nodejs.org/zh-cn/download/) |
| Git | 2.30.0+ | 版本控制 | [Git官网](https://git-scm.com/downloads) |
| VS Code | 1.60.0+ | 代码编辑（可选） | [VS Code官网](https://code.visualstudio.com/Download) |

### 1.2 环境配置验证
```bash
# 验证Node.js安装
node -v  # 应输出v16.14.0+
npm -v   # 应输出7.18.1+

# 配置npm镜像源（加速依赖安装）
npm config set registry https://registry.npmmirror.com
```

## 二、项目初始化步骤

### 2.1 创建小程序项目
1. 打开微信开发者工具，选择「小程序」→「新建项目」
2. 填写项目信息：
   - **项目名称**：智能停车场预约系统
   - **目录**：选择本地空文件夹（如`/workspace/parking-miniprogram`）
   - **AppID**：使用测试号（正式开发需替换为企业AppID）
   - **模板选择**：「JavaScript基础模板」
   - **后端服务**：不使用云服务（选择「不使用云开发」）
3. 点击「确定」完成创建

### 2.2 目录结构设计
```
parking-miniprogram/
├── pages/                 # 业务页面
│   ├── index/             # 首页（停车场列表）
│   ├── reservation/       # 预约页面
│   ├── navigation/        # 导航页面
│   ├── my/                # 个人中心
│   └── common/            # 公共页面（如登录/注册）
├── components/            # 自定义组件
│   ├── parking-card/      # 停车场卡片组件
│   ├── reservation-form/  # 预约表单组件
│   └── voice-button/      # 语音交互按钮
├── utils/                 # 工具函数
│   ├── api.js             # 接口请求封装
│   ├── auth.js            # 登录授权工具
│   └── formatter.js       # 数据格式化工具
├── config/                # 配置文件
│   ├── api.js             # 接口地址配置
│   └── constants.js       # 常量定义
├── static/                # 静态资源
│   ├── images/            # 图片资源
│   └── styles/            # 全局样式
├── app.js                 # 应用入口
├── app.json               # 全局配置
├── app.wxss               # 全局样式
└── project.config.json    # 项目配置
```

### 2.3 基础配置修改

#### 2.3.1 全局配置（app.json）
```json
{
  "pages": [
    "pages/index/index",
    "pages/reservation/reservation",
    "pages/navigation/navigation",
    "pages/my/my"
  ],
  "window": {
    "backgroundTextStyle": "light",
    "navigationBarBackgroundColor": "#1677FF",
    "navigationBarTitleText": "智能停车场预约",
    "navigationBarTextStyle": "white"
  },
  "tabBar": {
    "color": "#666666",
    "selectedColor": "#1677FF",
    "backgroundColor": "#ffffff",
    "list": [
      {
        "pagePath": "pages/index/index",
        "text": "首页",
        "iconPath": "static/images/tabbar/home.png",
        "selectedIconPath": "static/images/tabbar/home-active.png"
      },
      {
        "pagePath": "pages/reservation/reservation",
        "text": "预约",
        "iconPath": "static/images/tabbar/reserve.png",
        "selectedIconPath": "static/images/tabbar/reserve-active.png"
      },
      {
        "pagePath": "pages/my/my",
        "text": "我的",
        "iconPath": "static/images/tabbar/my.png",
        "selectedIconPath": "static/images/tabbar/my-active.png"
      }
    ]
  },
  "permission": {
    "scope.userLocation": {
      "desc": "获取位置信息用于附近停车场推荐"
    },
    "scope.record": {
      "desc": "获取录音用于语音交互"
    }
  },
  "usingComponents": {}
}
```

#### 2.3.2 项目配置（project.config.json）
```json
{
  "miniprogramRoot": "./",
  "projectname": "智能停车场预约系统",
  "description": "微信小程序智能停车场预约系统",
  "appid": "wx1234567890abcdef",  // 替换为实际AppID
  "setting": {
    "urlCheck": true,          // 开启URL校验
    "es6": true,               // 支持ES6转ES5
    "enhance": true,
    "postcss": true,
    "minified": true,          // 代码压缩
    "newFeature": true
  },
  "compileType": "miniprogram",
  "condition": {}
}
```

### 2.4 安装UI组件库（Vant Weapp）
1. 在项目根目录执行命令：
```bash
# 安装Vant Weapp组件库
npm i @vant/weapp -S --production
```
2. 配置微信开发者工具：
   - 「工具」→「构建npm」
   - 勾选「使用npm模块」（详情→本地设置→使用npm模块）
3. 在页面json中引入组件（如首页`pages/index/index.json`）：
```json
{
  "usingComponents": {
    "van-button": "@vant/weapp/button/index",
    "van-card": "@vant/weapp/card/index",
    "van-search": "@vant/weapp/search/index"
  }
}
```

## 三、基础功能开发示例

### 3.1 首页开发（pages/index/index.wxml）
```html
<van-search 
  placeholder="搜索停车场" 
  bind:search="onSearch"
  style="margin: 16rpx;"
/>

<view class="parking-list">
  <van-card 
    wx:for="{{parkingList}}" 
    wx:key="id"
    title="{{item.name}}"
    desc="{{item.address}}"
    thumb="{{item.image}}"
    class="parking-card"
    bind:click="navigateToDetail"
  >
    <view slot="footer">
      <view>剩余车位：{{item.availableSpaces}}/{{item.totalSpaces}}</view>
      <van-button type="primary" size="small" bind:click="handleReservation">
        立即预约
      </van-button>
    </view>
  </van-card>
</view>
```

### 3.2 接口请求封装（utils/api.js）
```javascript
// 基础域名（开发环境）
const BASE_URL = 'http://localhost:8080/api/v1';

/**
 * 封装wx.request
 * @param {string} url - 接口路径
 * @param {Object} options - 请求参数
 */
export const request = (url, options = {}) => {
  return new Promise((resolve, reject) => {
    wx.request({
      url: `${BASE_URL}${url}`,
      method: options.method || 'GET',
      data: options.data || {},
      header: {
        'Content-Type': 'application/json',
        'Authorization': wx.getStorageSync('token') || ''
      },
      success: (res) => {
        if (res.statusCode === 200) {
          resolve(res.data);
        } else {
          reject(new Error(`请求失败：${res.errMsg}`));
        }
      },
      fail: (err) => {
        reject(err);
      }
    });
  });
};

// 停车场相关接口
export const parkingApi = {
  // 获取停车场列表
  getList: (params) => request('/parking/list', { 
    method: 'GET', 
    data: params 
  }),
  // 获取停车场详情
  getDetail: (id) => request(`/parking/${id}`)
};
```

## 四、版本控制与协作

### 4.1 初始化Git仓库
```bash
# 项目根目录执行
git init
git add .
git commit -m "feat: 初始化小程序项目，完成基础配置"
```

### 4.2 创建.gitignore文件
```
# 依赖目录
node_modules/
# 微信开发者工具缓存
.miniprogram/
# 编译产物
miniprogram_npm/
# 日志文件
logs/
# 编辑器配置（可选）
.idea/
.vscode/
# 系统文件
.DS_Store
Thumbs.db
```

## 五、开发规范与注意事项

### 5.1 代码规范
- **命名规范**：
  - 文件夹/文件：kebab-case（如`parking-list`）
  - 组件/页面：PascalCase（如`ParkingCard`）
  - 变量/函数：camelCase（如`handleReservation`）
- **样式规范**：使用rpx单位（750rpx=屏幕宽度）
- **接口规范**：遵循RESTful设计（GET查询/POST创建/PUT更新/DELETE删除）

### 5.2 安全注意事项
- 敏感数据（如用户token）使用`wx.setStorageSync`存储
- 网络请求必须在`app.json`中配置合法域名（开发环境可勾选「不校验合法域名」）
- 用户位置信息需通过`wx.getLocation`授权后获取

### 5.3 调试技巧
- 使用「预览」功能生成二维码在真机测试
- 开启「VConsole」调试（详情→本地设置→调试基础库→显示VConsole）
- 接口请求可通过「Network」面板查看请求详情

## 六、下一步开发计划
1. 完成首页/预约页/个人中心静态页面开发
2. 集成高德地图SDK（详见《第三方服务集成文档》）
3. 开发用户登录/授权功能
4. 联调停车场列表接口