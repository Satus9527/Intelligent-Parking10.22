# 智能停车场系统数据库初始化说明

## 初始化脚本说明

本项目提供了两个数据库初始化脚本：

1. **init_full_database.sql** - 完整版本，包含表结构和测试数据
2. **init_database_no_test_data.sql** - 精简版本，只包含表结构，不包含测试数据（新创建）

## 执行步骤（使用不含测试数据的脚本）

### 前置条件
- MySQL 8.0.28+ 已安装并运行
- 拥有MySQL管理员权限（通常是root用户）

### 方法一：命令行执行

1. 打开命令提示符（Windows）或终端（Linux/Mac）
2. 确保MySQL服务已启动
3. 执行以下命令：

```bash
# Windows环境
mysql -uroot -p < init_database_no_test_data.sql

# Linux/Mac环境
mysql -uroot -p < init_database_no_test_data.sql
```

4. 输入MySQL root用户密码，按回车执行
5. 等待脚本执行完成，会显示初始化成功消息

### 方法二：MySQL客户端工具执行

1. 打开MySQL客户端工具（如MySQL Workbench、Navicat等）
2. 连接到MySQL服务器
3. 打开`init_database_no_test_data.sql`文件
4. 执行整个脚本

## 注意事项

1. **数据库名称**：脚本会自动创建名为`parking_db`的数据库，无需手动创建
2. **字符集设置**：脚本已设置为utf8mb4字符集，支持中文等多语言字符
3. **表结构**：脚本创建了四个核心表：
   - `parking_lot` - 停车场信息表
   - `parking_space` - 停车位信息表
   - `user` - 用户表
   - `reservation` - 预约记录表
4. **外键约束**：表之间已建立外键关联，确保数据完整性
5. **索引设计**：已为常用查询字段创建索引，优化查询性能

## 后续操作

初始化完成后，系统数据库结构已经准备就绪，但没有任何数据。您需要：

1. 手动添加停车场信息到`parking_lot`表
2. 为每个停车场添加停车位信息到`parking_space`表
3. 更新停车场的`total_spaces`和`available_spaces`字段

## 常见问题排查

1. **权限错误**：确保使用的MySQL用户有足够权限创建数据库和表
2. **端口问题**：如果MySQL使用非默认端口（3306），需要在命令中指定端口：`-P 端口号`
3. **路径问题**：确保在执行命令时位于脚本所在目录，或使用完整路径指定脚本位置
4. **数据库已存在**：脚本会先删除已存在的`parking_db`数据库再创建新的，请注意备份重要数据

## 数据初始化示例（手动添加数据）

如果需要手动添加一些基础数据，可以使用以下SQL语句：

```sql
-- 添加停车场
INSERT INTO parking_lot (name, address, total_spaces, available_spaces, hourly_rate, longitude, latitude)
VALUES ('示例停车场', '示例地址', 50, 50, 5.00, 116.465766, 39.924113);

-- 添加停车位（假设有了ID为1的停车场）
INSERT INTO parking_space (parking_id, space_number, name, status, type)
VALUES (1, 'A01', 'A区1号', 'AVAILABLE', 'SMALL');

-- 添加用户（可选）
INSERT INTO user (openid, nickname, phone, status)
VALUES ('wx_12345678', '测试用户', '13800138000', 0);
```

## 联系方式

如有数据库相关问题，请联系技术支持。