# 智能停车场小程序 - 界面功能结构设计概述

## 一、整体架构

### 1.1 应用结构
- **应用类型**: 微信小程序
- **主要功能模块**: 首页、停车场、预约、我的
- **底部导航栏**: 4个主要入口（首页、停车场、预约、我的）

### 1.2 页面路由结构
```
首页 (pages/index/index)
├── 登录页 (pages/login/login)
停车场模块 (pages/parking/)
├── 列表页 (pages/parking/list)
└── 详情页 (pages/parking/detail)
预约模块 (pages/reservation/)
├── 列表页 (pages/reservation/index)
└── 详情页 (pages/reservation/detail)
用户模块 (pages/user/)
├── 个人中心 (pages/user/profile)
└── 预约记录 (pages/user/reservations)
```

---

## 二、核心页面功能设计

### 2.1 首页 (index)

#### 2.1.1 功能模块
1. **搜索栏**
   - 搜索输入框
   - 实时搜索功能
   - 清空按钮
   - 搜索结果展示

2. **地图模块**
   - 地图显示
   - 用户位置定位
   - 停车场标记点
   - 地图控制按钮（定位功能）

3. **最近停车场列表**
   - 横向滚动列表
   - 停车场卡片展示
   - 显示距离、剩余车位数量
   - 点击跳转详情页

4. **推荐停车场**
   - 垂直列表展示
   - 停车场基本信息（名称、地址、距离、价格）
   - 车位状态指示（有车位/满位）
   - 查看更多入口

5. **公告栏**
   - 系统公告信息展示

#### 2.1.2 交互功能
- 搜索关键词输入与防抖处理
- 搜索结果列表展示与关闭
- 地图标记点击跳转详情
- 停车场卡片点击跳转详情
- 下拉刷新

---

### 2.2 停车场列表页 (parking/list)

#### 2.2.1 功能模块
1. **搜索栏**
   - 停车场名称搜索

2. **筛选栏**
   - 排序方式选择（距离优先、价格优先、评分优先）
   - 排序状态标识

3. **区域筛选**
   - 横向滚动区域标签
   - 全部/具体区域筛选
   - 选中状态标识

4. **停车场列表**
   - 停车场卡片列表
   - 停车场图标/首字母
   - 停车场名称、地址
   - 距离、区域、价格、评分
   - 可用车位数量
   - 点击跳转详情页

5. **加载更多**
   - 分页加载功能
   - 加载状态提示

6. **空状态**
   - 无数据时的提示信息

#### 2.2.2 交互功能
- 搜索输入与实时筛选
- 排序方式切换
- 区域筛选切换
- 列表滚动加载
- 卡片点击跳转详情

---

### 2.3 停车场详情页 (parking/detail)

#### 2.3.1 功能模块
1. **页面状态**
   - 加载状态
   - 错误状态（重试功能）

2. **停车场基本信息**
   - 停车场名称
   - 元数据展示（距离、区域、价格、评分）
   - 详细地址
   - 可用车位统计（可用/总数）

3. **操作按钮组**
   - 导航功能
   - 电话拨打
   - 分享功能

4. **停车场详情**
   - 停车场介绍
   - 特色功能列表
   - 营业时间
   - 联系电话

5. **可用车位展示**
   - 区域分组显示
   - 区域标题与统计
   - 车位列表
     - 车位号
     - 车位类型（如电动车位）
     - 车位状态（可用/已占）
     - 车位选择功能
   - 无数据状态提示

6. **预约表单**
   - 车牌号选择器
   - 车牌号选择模态框
     - 车辆列表
     - 车辆信息（车牌号、类型）
     - 选中状态标识

7. **底部操作**
   - 立即预约按钮

#### 2.3.2 交互功能
- 车位选择（单选）
- 车牌号选择器打开/关闭
- 车辆选择
- 预约提交
- 导航跳转
- 电话拨打
- 分享功能
- 下拉刷新

---

### 2.4 预约列表页 (reservation/index)

#### 2.4.1 功能模块
1. **页面头部**
   - 页面标题

2. **页面状态**
   - 加载状态（加载动画、提示文字）
   - 错误状态（错误图标、错误信息、重试按钮）
   - 空状态（空图标、提示文字、去预约按钮）

3. **预约记录列表**
   - 预约卡片
     - 头部信息（停车场名称、状态标签）
     - 内容信息（车位号、预约时间）
     - 底部操作（查看详情入口）

#### 2.4.2 交互功能
- 预约记录加载
- 预约卡片点击查看详情
- 错误重试
- 空状态跳转停车场列表
- 下拉刷新

---

### 2.5 预约详情页 (reservation/detail)

#### 2.5.1 功能模块
1. **页面状态**
   - 加载状态
   - 错误状态（重试功能）

2. **状态卡片**
   - 预约状态（待使用/已完成/已取消）
   - 支付状态（已支付/未支付）

3. **预约信息**
   - 停车场名称
   - 停车场地址
   - 车位号
   - 预约时间

4. **使用信息**
   - 实际开始时间
   - 实际结束时间
   - 预约金额
   - 创建时间

5. **操作按钮**
   - 立即支付（条件显示）
   - 取消预约（条件显示）
   - 返回按钮

#### 2.5.2 交互功能
- 支付功能
- 取消预约
- 返回上一页
- 错误重试

---

### 2.6 个人中心页 (user/profile)

#### 2.6.1 功能模块
1. **用户信息卡片**
   - 用户头像/图标
   - 用户名称
   - 用户ID

2. **功能菜单列表**
   - 我的预约
   - 停车记录
   - 设置

#### 2.6.2 交互功能
- 菜单项点击跳转
- 返回导航

---

## 三、数据流设计

### 3.1 数据获取方式
- **后端API调用**: 所有数据通过HTTP请求从后端获取
- **数据格式**: JSON格式
- **错误处理**: 统一的错误提示和重试机制

### 3.2 主要数据接口
- 停车场列表查询（支持区域筛选、排序）
- 停车场详情查询
- 车位可用性查询
- 预约创建
- 用户预约列表查询
- 预约详情查询
- 搜索功能

### 3.3 数据状态管理
- 页面级状态管理（data）
- 全局状态管理（app.globalData）
- 加载状态、错误状态、空状态管理

---

## 四、交互设计

### 4.1 导航流程
```
首页
├── 搜索 → 搜索结果 → 详情页
├── 地图标记 → 详情页
├── 停车场卡片 → 详情页
└── 查看更多 → 列表页

列表页
├── 搜索 → 筛选结果
├── 筛选/排序 → 更新列表
└── 停车场卡片 → 详情页

详情页
├── 选择车位 → 预约表单
├── 选择车牌 → 车牌选择器
└── 立即预约 → 预约创建 → 预约列表

预约列表
└── 预约卡片 → 预约详情

预约详情
├── 支付 → 支付流程
├── 取消 → 取消确认
└── 返回 → 预约列表

个人中心
├── 我的预约 → 预约列表
├── 停车记录 → 记录列表
└── 设置 → 设置页面
```

### 4.2 用户操作流程

#### 4.2.1 预约流程
1. 首页/列表页 → 选择停车场
2. 详情页 → 查看车位信息
3. 选择可用车位
4. 选择车牌号
5. 提交预约
6. 查看预约记录

#### 4.2.2 搜索流程
1. 输入搜索关键词
2. 显示搜索结果列表
3. 选择搜索结果
4. 跳转详情页

#### 4.2.3 筛选流程
1. 选择筛选条件（区域/排序）
2. 更新列表数据
3. 显示筛选结果

---

## 五、组件设计

### 5.1 通用组件
- **搜索栏**: 输入框、搜索图标、清空按钮
- **状态标签**: 预约状态、车位状态
- **加载状态**: 加载动画、加载文字
- **错误状态**: 错误图标、错误信息、重试按钮
- **空状态**: 空图标、提示文字、操作按钮
- **按钮组**: 导航、电话、分享等操作按钮

### 5.2 数据展示组件
- **停车场卡片**: 名称、地址、距离、价格、状态
- **预约卡片**: 停车场信息、车位信息、时间信息、状态
- **车位列表项**: 车位号、类型、状态、选择功能

### 5.3 交互组件
- **模态框**: 车牌选择器
- **下拉刷新**: 列表刷新功能
- **上拉加载**: 分页加载功能

---

## 六、功能特性

### 6.1 核心功能
- 停车场搜索
- 停车场列表浏览
- 停车场详情查看
- 车位实时查询
- 车位预约
- 预约管理
- 用户位置定位
- 地图导航

### 6.2 辅助功能
- 区域筛选
- 排序功能（距离、价格、评分）
- 搜索功能
- 分享功能
- 电话拨打
- 导航功能

### 6.3 用户体验优化
- 加载状态提示
- 错误处理与重试
- 空状态提示
- 下拉刷新
- 分页加载
- 防抖处理（搜索）

---

## 七、页面状态管理

### 7.1 状态类型
- **加载状态**: 数据加载中
- **成功状态**: 数据加载成功，正常展示
- **错误状态**: 数据加载失败，显示错误信息和重试
- **空状态**: 无数据，显示空状态提示

### 7.2 状态切换逻辑
- 页面加载时显示加载状态
- 数据获取成功切换到成功状态
- 数据获取失败切换到错误状态
- 数据为空切换到空状态

---

## 八、权限与功能限制

### 8.1 位置权限
- 获取用户位置用于推荐附近停车场
- 权限请求与授权处理
- 权限拒绝时的降级处理

### 8.2 用户状态
- 登录状态检查
- 自动登录处理
- Token管理

---

## 九、技术实现要点

### 9.1 数据交互
- RESTful API调用
- 请求参数处理
- 响应数据格式化
- 错误码处理

### 9.2 性能优化
- 列表分页加载
- 图片懒加载
- 防抖处理
- 数据缓存

### 9.3 用户体验
- 加载动画
- 过渡动画
- 交互反馈
- 错误提示

---

## 十、页面结构总结

### 10.1 页面层级
- **一级页面**: 底部导航栏页面（首页、停车场、预约、我的）
- **二级页面**: 详情页、列表页
- **三级页面**: 预约详情页

### 10.2 页面复杂度
- **简单页面**: 个人中心、预约列表
- **中等页面**: 首页、停车场列表
- **复杂页面**: 停车场详情、预约详情

### 10.3 数据展示方式
- **列表展示**: 停车场列表、预约列表
- **卡片展示**: 停车场卡片、预约卡片
- **详情展示**: 停车场详情、预约详情
- **地图展示**: 地图标记与定位

---

## 十一、扩展功能预留

### 11.1 可扩展功能
- 支付功能
- 评价功能
- 收藏功能
- 历史记录
- 消息通知
- 优惠券
- 会员功能

### 11.2 可优化方向
- 离线缓存
- 数据预加载
- 智能推荐
- 个性化设置
- 多语言支持

---

## 十二、设计原则

### 12.1 信息架构
- 清晰的层级结构
- 合理的信息分组
- 直观的导航路径

### 12.2 交互设计
- 明确的操作反馈
- 流畅的页面切换
- 友好的错误处理

### 12.3 内容展示
- 重点信息突出
- 信息层次清晰
- 状态标识明确

---

**文档版本**: v1.0  
**最后更新**: 2025年  
**适用范围**: 智能停车场小程序界面功能结构设计

